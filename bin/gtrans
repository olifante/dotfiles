#!/usr/bin/ruby -w

require 'rubygems'
require 'open-uri'
require 'json'

sl = 'en'
tl = 'fr'

if ARGV.first == 'fr'
  ARGV.shift
  sl, tl = tl, sl
end

args = ARGV.join(' ')
exit if args.empty?

url = URI.escape("http://translate.google.com/translate_a/t?client=j&text=#{args}&sl=#{sl}&tl=#{tl}")
res = open(url).read

json = JSON.parse(res)
text = json['sentences'].first['trans']

puts text

exit
